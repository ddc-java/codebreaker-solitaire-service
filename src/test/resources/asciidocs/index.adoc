= Codebreaker Solitaire API Guide
Nicholas Bennett <nick@nickbenn.com>
v{projectVersion}
:doctype: book
:favicon: img/deep-dive-all-cohorts.png
:icons: font
:source-highlighter: highlightjs
:toc: left
:toclevels: 3
:sectlinks:

[[codebreaker_overview]]
== What is _Codebreaker_?

_Codebreaker_ is a simple game of deductive reasoning---a more generalized variant of the board game _Mastermind_ and the earlier pencil-and-paper game _Bulls and Cows_---implemented as a RESTful service that permits clients (consumers of the service) to present the game to users for play.

[[play_overview]]
== Rules of play

=== Players

There are 2 roles in the game: _codemaker_ and _codebreaker_. In the pencil-and-paper and board game variants, players typically alternate playing these roles; in this variant, the service is always the codemaker, and the client is always the codebreaker. Thus, in its current implementation, this is a solitaire game: a client application requests generation of a game from the service, and then submits the user's guesses to the service, one at a time, displaying the response to the user.

=== Sequence of play

==== Start a new game

A game begins when the codebreaker requests that a new code be generated, with the code length and pool of characters specified in the request.

See <<post_game_endpoint,`POST /codebreaker/games`>> for details on requesting the generation of a new code (thus starting a new game) from this service.

==== Guessing the game

The objective of the codebreaker in the game is to guess a secret code (created by the codemaker, within parameters agreed on by both players), in as few guesses as possible.

Each guess consists of a string of characters (which must be of the same length as the code---that is, the length specified when starting the game). When a guess is submitted, the response from the codemaker consists (primarily) of 2 numbers:

* *Exact matches*
+
The number of characters in the code that are matched _exactly_ by the characters in the corresponding positions of the guess.

* *Near matches*
+
The number of characters in the code that are not matched _exactly_ by the guess, but that are matched by characters in the guess in non-corresponding positions.

The codebreaker would then use this information to refine each subsequent guess.

See <<post_guess_endpoint,`POST /codebreaker/games/{gameId}/guesses`>> for details on submitting a guess to this service, and the information returned by the service.

==== End of play

The game ends when the codebreaker successfully guesses the code.

== Service endpoints

[[post_game_endpoint]]
=== Start new game

==== Request

`POST /codebreaker/games`

Starts a new game, randomly generating a secret code using the properties specified in the request body.

===== Body

|===
|Type|Description

|<<game_post_schema,`Game`>>
|Code generation settings.

|===

==== Responses

|===
|Status|Body|Description

|201 Created
|<<game_get_schema,`Game`>>
|Code generated & game started successfully.
|400 Bad Request
|<<error_schema,`Error`>>
|Invalid code length or character pool.

|===

==== Example

===== Request

include::{snippets}/games/post-valid/http-request.adoc[]

===== Response

include::{snippets}/games/post-valid/http-response.adoc[]

=== List games

==== Request

`GET /codebreaker/games`

Returns a subset of games (all, in-progress/unsolved, or completed/solved), in descending order of creation date (i.e. most recently created first).

Note that inactive games are periodically removed from the database. Currently, inactive games are those which---regardless of whether they have been completed (solved)---have had no guesses submitted in the most recent 14 days. Thus, responses produced by the Codebreaker service for the `GET` request documented here will not include such games.

===== Query parameters

include::{snippets}/games/list-all/request-parameters.adoc[]

==== Responses

|===
|Status|Body|Description

|200 OK
|<<game_get_schema,`Game[]`>>
|Specified subset queried & returned successfully.
|400 Bad Request
|<<error_schema,`Error`>>
|Invalid `status` query parameter value.

|===

==== Example 1: All games

===== Request

include::{snippets}/games/list-all/http-request.adoc[]

===== Response

include::{snippets}/games/list-all/http-response.adoc[]

==== Example 2: In-progress games

An in-progress (unsolved) game is one in which no guess that has been submitted so far matches the secret code exactly.

===== Request

include::{snippets}/games/list-unsolved/http-request.adoc[]

===== Response

include::{snippets}/games/list-unsolved/http-response.adoc[]

==== Example 3: Completed games

A completed (solved) game is one in which a guess exactly matching the secret code has been successfully submitted.

===== Request

include::{snippets}/games/list-solved/http-request.adoc[]

===== Response

include::{snippets}/games/list-solved/http-response.adoc[]

=== Get a single game

==== Request

`GET /codebreaker/games/{gameId}`

Returns the game with the unique identifier `gameId`.

===== Path parameters

include::{snippets}/games/get-valid/path-parameters.adoc[]

==== Responses

|===
|Status|Body|Description

|200 OK
|<<game_get_schema,`Game`>>
|Specified game returned.
|404 Not Found
|<<error_schema,`Error`>>
|No game exists with an `id` equal to the specified `gameId`.

|===

==== Example

===== Request

include::{snippets}/games/get-valid/http-request.adoc[]

===== Response

include::{snippets}/games/get-valid/http-response.adoc[]

=== Delete a game

==== Request

`DELETE /codebreaker/games/{gameId}`

Deletes the game (and all related guesses) with the unique identifier `gameId`.

===== Path parameters

include::{snippets}/games/get-valid/path-parameters.adoc[]

==== Responses

|===
|Status|Body|Description

|204 No Content
|_(none)_
|Specified game deleted.
|404 Not Found
|<<error_schema,`Error`>>
|No game exists with an `id` equal to the specified `gameId`.

|===

==== Example

===== Request

include::{snippets}/games/delete-valid/http-request.adoc[]

===== Response

include::{snippets}/games/delete-valid/http-response.adoc[]

[[post_guess_endpoint]]
=== Submit a guess

==== Request

`POST /codebreaker/games/{gameId}/guesses`

Submits a guess against the game specified by `gameId`.

===== Path parameters

include::{snippets}/guesses/post-valid/path-parameters.adoc[]

===== Body

|===
|Type|Description

|<<guess_post_schema,`Guess`>>
|Text of guess.

|===

==== Responses

|===
|Status|Body|Description

|201 OK
|<<guess_get_schema,`Guess`>>
|Guess submitted successfully.
|400 Bad Request
|<<error_schema,`Error`>>
|Length of guess doesn't match code length.
|404 Not Found
|<<error_schema,`Error`>>
|No game exists with an `id` equal to the specified `gameId`.

|===

==== Example

===== Request

include::{snippets}/guesses/post-valid/http-request.adoc[]

===== Response

include::{snippets}/guesses/post-valid/http-response.adoc[]

=== List guesses for a game

==== Request

`GET /codebreaker/games/{gameId}/guesses`

Retrieves all guesses submitted in the game specified by `gameId`.

===== Path parameters

include::{snippets}/guesses/list-valid/path-parameters.adoc[]

==== Responses

|===
|Status|Body|Description

|200 OK
|<<guess_get_schema,`Guess[]`>>
|Guesses associated with specified game queried & returned successfully.
|404 Not Found
|<<error_schema,`Error`>>
|No game exists with an `id` equal to the specified `gameId`.

|===

==== Example

===== Request

include::{snippets}/guesses/list-valid/http-request.adoc[]

===== Response

include::{snippets}/guesses/list-valid/http-response.adoc[]

=== Get a single guess

==== Request

`GET /codebreaker/games/{gameId}/guesses/{guessId}`

Returns the guess with the unique identifier `guessId` submitted in the game identified by `gameId`.

===== Path parameters

include::{snippets}/guesses/get-valid/path-parameters.adoc[]

==== Responses

|===
|Status|Body|Description

|200 OK
|<<guess_get_schema,`Guess`>>
|Specified guess returned.
|404 Not Found
|<<error_schema,`Error`>>
|No game exists with an `id` equal to the specified `gameId`, no guess identified by `guessId` exists, or guess identified by `guessId` is not associated with game identified by `gameId`.

|===

==== Example

===== Request

include::{snippets}/guesses/get-valid/http-request.adoc[]

===== Response

include::{snippets}/guesses/get-valid/http-response.adoc[]

== Schemas

[[game_schema]]
=== `Game`

[[game_post_schema]]
==== `POST` request body

include::{snippets}/games/post-valid/request-fields.adoc[]

[[game_get_schema]]
==== `GET` & `POST` response body

include::{snippets}/games/get-valid/response-fields.adoc[]

[[guess_schema]]
=== `Guess`

[[guess_post_schema]]
==== `POST` request body

include::{snippets}/guesses/post-valid/request-fields.adoc[]

[[guess_get_schema]]
==== `GET` & `POST` response body

include::{snippets}/guesses/get-valid/response-fields.adoc[]

[[error_schema]]
=== `Error`

include::{snippets}/games/post-invalid/response-fields.adoc[]

[[license_notices]]
== Copyrights and licenses

[discrete]
=== Codebreaker

(C) 2022 CNM Ingenuity, Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

[discrete]
=== Spring Framework, Spring Boot, Spring Data, Spring HATEOAS, Spring REST Docs

(C) 2012-2021 the original author or authors.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

[discrete]
=== Hibernate ORM

(C) 2021 Red Hat Inc.

Licensed under the GNU Lesser General Public Library, version 2.1. You can find a copy of this license at https://www.gnu.org/licenses/lgpl-2.1.en.html
